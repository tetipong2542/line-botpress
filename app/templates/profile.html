{% extends "base.html" %}

{% block title %}‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå - ‡∏à‡∏î‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢{% endblock %}

{% block content %}
<div class="mobile-container">
    <!-- Header -->
    <div class="page-header">
        <div class="header-content">
            <h1>
                <i data-lucide="user"></i>
                ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå
            </h1>
            <p class="subtitle">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</p>
        </div>
    </div>

    <!-- User Profile Section -->
    <div class="section">
        <div class="profile-card">
            <div class="profile-avatar">
                {% if user and user.picture_url %}
                    <img src="{{ user.picture_url }}" alt="{{ user.display_name }}" class="profile-avatar-img">
                {% else %}
                    <i data-lucide="user"></i>
                {% endif %}
            </div>
            <div class="profile-info">
                <h2>{% if user %}{{ user.display_name }}{% else %}Guest User{% endif %}</h2>
                <p class="profile-email">
                    {% if user and user.email %}
                        {{ user.email }}
                    {% elif user %}
                        LINE ID: {{ user.line_user_id[:8] }}...
                    {% else %}
                        ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
                    {% endif %}
                </p>
            </div>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="section">
        <div class="section-header">
            <h2>
                <i data-lucide="zap"></i>
                ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß
            </h2>
        </div>

        <div class="settings-list">
            <a href="/members" class="setting-item">
                <div class="setting-icon">
                    <i data-lucide="users"></i>
                </div>
                <div class="setting-info">
                    <div class="setting-title">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</div>
                    <div class="setting-desc">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß</div>
                </div>
                <i data-lucide="chevron-right"></i>
            </a>

            <a href="/budgets" class="setting-item">
                <div class="setting-icon">
                    <i data-lucide="target"></i>
                </div>
                <div class="setting-info">
                    <div class="setting-title">‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</div>
                    <div class="setting-desc">‡∏ï‡∏±‡πâ‡∏á‡∏á‡∏ö‡∏£‡∏≤‡∏¢‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</div>
                </div>
                <i data-lucide="chevron-right"></i>
            </a>

            <a href="/analytics" class="setting-item">
                <div class="setting-icon">
                    <i data-lucide="bar-chart-2"></i>
                </div>
                <div class="setting-info">
                    <div class="setting-title">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô</div>
                    <div class="setting-desc">‡∏î‡∏π‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</div>
                </div>
                <i data-lucide="chevron-right"></i>
            </a>
        </div>
    </div>

    <!-- Account Settings -->
    <div class="section">
        <div class="section-header">
            <h2>
                <i data-lucide="settings"></i>
                ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ö‡∏±‡∏ç‡∏ä‡∏µ
            </h2>
        </div>

        <div class="settings-list">
            <a href="#" class="setting-item" id="about-app">
                <div class="setting-icon">
                    <i data-lucide="info"></i>
                </div>
                <div class="setting-info">
                    <div class="setting-title">‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÅ‡∏≠‡∏õ</div>
                    <div class="setting-desc">‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô 1.0.0</div>
                </div>
                <i data-lucide="chevron-right"></i>
            </a>
        </div>
    </div>

    <!-- Logout Button -->
    <div class="section">
        <button class="btn-logout" id="logout-btn">
            <i data-lucide="log-out"></i>
            <span>‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</span>
        </button>
    </div>

    <!-- Footer -->
    <div class="section" style="text-align: center; padding: 20px 0;">
        <p style="font-size: 12px; color: var(--text-secondary);">
            ‡∏ó‡∏≥‡∏î‡πâ‡∏ß‡∏¢ ‚ù§Ô∏è ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ô‡πÑ‡∏ó‡∏¢
        </p>
    </div>

    <!-- Bottom spacing -->
    <div class="footer-spacing"></div>
</div>

<!-- Sticky Footer Menu -->
{% set current_page = 'profile' %}
{% include 'components/footer_menu.html' %}
{% endblock %}

{% block extra_js %}
<script>
// Logout
document.getElementById('logout-btn').addEventListener('click', async () => {
    if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
        try {
            const response = await fetch('/auth/logout', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                }
            });

            if (response.ok) {
                window.location.href = '/';
            } else {
                alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á');
            }
        } catch (error) {
            console.error('Logout error:', error);
            // Fallback: redirect anyway
            window.location.href = '/';
        }
    }
});

// About App
document.getElementById('about-app').addEventListener('click', (e) => {
    e.preventDefault();
    alert('üì± PromptJOD {‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏à‡∏î}\n\n‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô: 1.0.0\n\n‡πÅ‡∏≠‡∏õ‡∏à‡∏î‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏á‡πà‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î\n‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ô‡πÑ‡∏ó‡∏¢\n\nMade with ‚ù§Ô∏è');
});
</script>
{% endblock %}
