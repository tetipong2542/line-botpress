{% extends "base.html" %}

{% block title %}‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå - ‡∏à‡∏î‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢{% endblock %}

{% block content %}
<div class="mobile-container">
    <!-- Header -->
    <div class="page-header">
        <div class="header-content">
            <h1>
                <i data-lucide="user"></i>
                ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå
            </h1>
            <p class="subtitle">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</p>
        </div>
    </div>

    <!-- User Profile Section -->
    <div class="section">
        <div class="profile-card">
            <div class="profile-avatar">
                {% if user and user.picture_url %}
                    <img src="{{ user.picture_url }}" alt="{{ user.display_name }}" class="profile-avatar-img">
                {% else %}
                    <i data-lucide="user"></i>
                {% endif %}
            </div>
            <div class="profile-info">
                <h2>{% if user %}{{ user.display_name }}{% else %}Guest User{% endif %}</h2>
                <p class="profile-email">
                    {% if user and user.email %}
                        {{ user.email }}
                    {% elif user %}
                        LINE ID: {{ user.line_user_id[:8] }}...
                    {% else %}
                        ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
                    {% endif %}
                </p>
            </div>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="section">
        <div class="section-header">
            <h2>
                <i data-lucide="zap"></i>
                ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß
            </h2>
        </div>

        <div class="settings-list">
            <a href="/members" class="setting-item">
                <div class="setting-icon">
                    <i data-lucide="users"></i>
                </div>
                <div class="setting-info">
                    <div class="setting-title">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</div>
                    <div class="setting-desc">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß</div>
                </div>
                <span class="feature-badge available">
                    <span class="badge-dot"></span>
                </span>
            </a>

            <a href="/budgets" class="setting-item">
                <div class="setting-icon">
                    <i data-lucide="target"></i>
                </div>
                <div class="setting-info">
                    <div class="setting-title">‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</div>
                    <div class="setting-desc">‡∏ï‡∏±‡πâ‡∏á‡∏á‡∏ö‡∏£‡∏≤‡∏¢‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</div>
                </div>
                <span class="feature-badge available">
                    <span class="badge-dot"></span>
                </span>
            </a>

            <a href="/analytics" class="setting-item">
                <div class="setting-icon">
                    <i data-lucide="bar-chart-2"></i>
                </div>
                <div class="setting-info">
                    <div class="setting-title">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô</div>
                    <div class="setting-desc">‡∏î‡∏π‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</div>
                </div>
                <span class="feature-badge available">
                    <span class="badge-dot"></span>
                </span>
            </a>
        </div>
    </div>

    <!-- Available Features -->
    <div class="section">
        <div class="section-header">
            <h2>
                <i data-lucide="check-circle"></i>
                ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ
            </h2>
        </div>

        <div class="settings-list">
            <a href="#" class="setting-item" id="notifications-settings">
                <div class="setting-icon">
                    <i data-lucide="bell"></i>
                </div>
                <div class="setting-info">
                    <div class="setting-title">‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</div>
                    <div class="setting-desc">‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏à‡∏≥</div>
                </div>
                <span class="feature-badge available">
                    <span class="badge-dot"></span>
                </span>
            </a>

            <div class="setting-item" id="dark-mode-setting">
                <div class="setting-icon">
                    <i data-lucide="moon"></i>
                </div>
                <div class="setting-info">
                    <div class="setting-title">‡πÇ‡∏´‡∏°‡∏î‡∏°‡∏∑‡∏î</div>
                    <div class="setting-desc">‡∏õ‡∏£‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏≤‡πÅ‡∏≠‡∏õ‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏ó‡∏ô‡∏°‡∏∑‡∏î</div>
                </div>
                <div class="setting-toggle">
                    <label class="switch">
                        <input type="checkbox" class="dark-mode-toggle" id="dark-mode-toggle-switch">
                        <span class="slider"></span>
                    </label>
                </div>
            </div>

            <a href="#" class="setting-item" id="about-app">
                <div class="setting-icon">
                    <i data-lucide="info"></i>
                </div>
                <div class="setting-info">
                    <div class="setting-title">‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÅ‡∏≠‡∏õ</div>
                    <div class="setting-desc">‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô 1.0.0</div>
                </div>
                <span class="feature-badge available">
                    <span class="badge-dot"></span>
                </span>
            </a>
        </div>
    </div>

    <!-- Coming Soon Features -->
    <div class="section">
        <div class="section-header">
            <h2>
                <i data-lucide="rocket"></i>
                ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤
            </h2>
        </div>

        <div class="settings-list">
            <div class="setting-item disabled">
                <div class="setting-icon">
                    <i data-lucide="download"></i>
                </div>
                <div class="setting-info">
                    <div class="setting-title">‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>
                    <div class="setting-desc">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå</div>
                </div>
                <span class="feature-badge in-development">
                    <i data-lucide="code"></i>
                    ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤
                </span>
            </div>

            <div class="setting-item disabled">
                <div class="setting-icon">
                    <i data-lucide="help-circle"></i>
                </div>
                <div class="setting-info">
                    <div class="setting-title">‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠</div>
                    <div class="setting-desc">‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢‡πÅ‡∏•‡∏∞‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠</div>
                </div>
                <span class="feature-badge coming-soon">
                    <i data-lucide="clock"></i>
                    ‡πÄ‡∏£‡πá‡∏ß‡πÜ ‡∏ô‡∏µ‡πâ
                </span>
            </div>
        </div>
    </div>

    <!-- Logout Button -->
    <div class="section">
        <button class="btn-logout" id="logout-btn">
            <i data-lucide="log-out"></i>
            <span>‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</span>
        </button>
    </div>

    <!-- Footer -->
    <div class="section" style="text-align: center; padding: 20px 0;">
        <p style="font-size: 12px; color: var(--text-secondary);">
            ‡∏ó‡∏≥‡∏î‡πâ‡∏ß‡∏¢ ‚ù§Ô∏è ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ô‡πÑ‡∏ó‡∏¢ ‚Ä¢ ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô 1.0.0
        </p>
    </div>

    <!-- Bottom spacing -->
    <div class="footer-spacing"></div>
</div>

<!-- Modal: Notification Settings -->
<div class="modal" id="notification-settings-modal">
    <div class="modal-overlay"></div>
    <div class="modal-content modal-large">
        <div class="modal-header" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
            <h2>
                <i data-lucide="bell"></i>
                ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
            </h2>
            <button class="modal-close" style="color: white;">
                <i data-lucide="x"></i>
            </button>
        </div>
        <div class="modal-body">
            <!-- Budget Alerts -->
            <div class="notification-section">
                <h3 style="font-size: 16px; font-weight: 600; margin-bottom: 12px; color: var(--text);">
                    <i data-lucide="target"></i>
                    ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì
                </h3>
                
                <div class="notification-toggle-item">
                    <div class="notification-toggle-info">
                        <div class="notification-toggle-title">‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</div>
                        <div class="notification-toggle-desc">‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏Å‡∏¥‡∏ô‡∏á‡∏ö‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏ß‡πâ</div>
                    </div>
                    <label class="switch">
                        <input type="checkbox" id="budget-alerts-toggle" checked>
                        <span class="slider"></span>
                    </label>
                </div>

                <div class="notification-settings-detail" id="budget-threshold-setting">
                    <label class="form-label">‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏ñ‡∏∂‡∏á</label>
                    <select class="form-select" id="budget-threshold">
                        <option value="50">50% ‡∏Ç‡∏≠‡∏á‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</option>
                        <option value="70">70% ‡∏Ç‡∏≠‡∏á‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</option>
                        <option value="80" selected>80% ‡∏Ç‡∏≠‡∏á‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</option>
                        <option value="90">90% ‡∏Ç‡∏≠‡∏á‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</option>
                        <option value="100">100% ‡∏Ç‡∏≠‡∏á‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</option>
                    </select>
                </div>
            </div>

            <!-- Recurring Reminders -->
            <div class="notification-section">
                <h3 style="font-size: 16px; font-weight: 600; margin-bottom: 12px; color: var(--text);">
                    <i data-lucide="refresh-cw"></i>
                    ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏à‡∏≥
                </h3>
                
                <div class="notification-toggle-item">
                    <div class="notification-toggle-info">
                        <div class="notification-toggle-title">‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏à‡∏≥</div>
                        <div class="notification-toggle-desc">‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡∏£‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏à‡∏≥</div>
                    </div>
                    <label class="switch">
                        <input type="checkbox" id="recurring-reminders-toggle" checked>
                        <span class="slider"></span>
                    </label>
                </div>

                <div class="notification-settings-detail" id="reminder-days-setting">
                    <label class="form-label">‡πÅ‡∏à‡πâ‡∏á‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤</label>
                    <select class="form-select" id="reminder-days">
                        <option value="0">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏£‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î</option>
                        <option value="1" selected>1 ‡∏ß‡∏±‡∏ô</option>
                        <option value="2">2 ‡∏ß‡∏±‡∏ô</option>
                        <option value="3">3 ‡∏ß‡∏±‡∏ô</option>
                        <option value="7">7 ‡∏ß‡∏±‡∏ô</option>
                    </select>
                </div>
            </div>

            <!-- LINE Notifications -->
            <div class="notification-section">
                <h3 style="font-size: 16px; font-weight: 600; margin-bottom: 12px; color: var(--text);">
                    <i data-lucide="message-circle"></i>
                    ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ú‡πà‡∏≤‡∏ô LINE
                </h3>
                
                <div class="notification-toggle-item">
                    <div class="notification-toggle-info">
                        <div class="notification-toggle-title">‡∏™‡πà‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ú‡πà‡∏≤‡∏ô LINE</div>
                        <div class="notification-toggle-desc">‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏ô‡πÅ‡∏≠‡∏õ LINE</div>
                    </div>
                    <label class="switch">
                        <input type="checkbox" id="line-notifications-toggle" checked>
                        <span class="slider"></span>
                    </label>
                </div>
            </div>

            <!-- Save Button -->
            <div style="margin-top: 24px;">
                <button class="btn-primary" id="save-notification-settings">
                    <i data-lucide="check"></i>
                    <span>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</span>
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Sticky Footer Menu -->
{% set current_page = 'profile' %}
{% include 'components/footer_menu.html' %}
{% endblock %}

{% block extra_js %}
<script>
// Notification Settings Modal
const notificationModal = document.getElementById('notification-settings-modal');
const notificationCloseBtn = notificationModal.querySelector('.modal-close');
const notificationOverlay = notificationModal.querySelector('.modal-overlay');

function openNotificationSettings() {
    notificationModal.classList.add('active');
    document.body.style.overflow = 'hidden';
    loadNotificationPreferences();
}

function closeNotificationSettings() {
    notificationModal.classList.remove('active');
    document.body.style.overflow = '';
}

// Open modal
document.getElementById('notifications-settings').addEventListener('click', (e) => {
    e.preventDefault();
    openNotificationSettings();
});

// Close modal
notificationCloseBtn.addEventListener('click', closeNotificationSettings);
notificationOverlay.addEventListener('click', closeNotificationSettings);

// Load notification preferences
async function loadNotificationPreferences() {
    try {
        const response = await fetch('/api/v1/notifications/preferences');
        if (response.ok) {
            const result = await response.json();
            const prefs = result.preferences;

            // Update UI
            document.getElementById('budget-alerts-toggle').checked = prefs.budget_alerts;
            document.getElementById('budget-threshold').value = prefs.budget_threshold;
            document.getElementById('recurring-reminders-toggle').checked = prefs.recurring_reminders;
            document.getElementById('reminder-days').value = prefs.reminder_days_before;
            document.getElementById('line-notifications-toggle').checked = prefs.line_notifications;

            // Show/hide detail settings
            toggleBudgetThresholdSetting();
            toggleReminderDaysSetting();
        }
    } catch (error) {
        console.error('Error loading preferences:', error);
    }
}

// Toggle budget threshold setting
document.getElementById('budget-alerts-toggle').addEventListener('change', toggleBudgetThresholdSetting);

function toggleBudgetThresholdSetting() {
    const isEnabled = document.getElementById('budget-alerts-toggle').checked;
    const setting = document.getElementById('budget-threshold-setting');
    setting.style.display = isEnabled ? 'block' : 'none';
}

// Toggle reminder days setting
document.getElementById('recurring-reminders-toggle').addEventListener('change', toggleReminderDaysSetting);

function toggleReminderDaysSetting() {
    const isEnabled = document.getElementById('recurring-reminders-toggle').checked;
    const setting = document.getElementById('reminder-days-setting');
    setting.style.display = isEnabled ? 'block' : 'none';
}

// Save notification settings
document.getElementById('save-notification-settings').addEventListener('click', async () => {
    const preferences = {
        budget_alerts: document.getElementById('budget-alerts-toggle').checked,
        budget_threshold: parseInt(document.getElementById('budget-threshold').value),
        recurring_reminders: document.getElementById('recurring-reminders-toggle').checked,
        reminder_days_before: parseInt(document.getElementById('reminder-days').value),
        line_notifications: document.getElementById('line-notifications-toggle').checked
    };

    try {
        const response = await fetch('/api/v1/notifications/preferences', {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(preferences)
        });

        if (response.ok) {
            showToast('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏•‡πâ‡∏ß ‚úÖ', 'success');
            closeNotificationSettings();
        } else {
            showToast('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á', 'error');
        }
    } catch (error) {
        console.error('Error saving preferences:', error);
        showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á', 'error');
    }
});

// Logout
document.getElementById('logout-btn').addEventListener('click', async () => {
    if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
        try {
            const response = await fetch('/auth/logout', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                }
            });

            if (response.ok) {
                window.location.href = '/';
            } else {
                alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á');
            }
        } catch (error) {
            console.error('Logout error:', error);
            // Fallback: redirect anyway
            window.location.href = '/';
        }
    }
});

// About App
document.getElementById('about-app').addEventListener('click', (e) => {
    e.preventDefault();
    alert('üì± PromptJOD {‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏à‡∏î}\n\n‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô: 1.0.0\n\n‡πÅ‡∏≠‡∏õ‡∏à‡∏î‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏á‡πà‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î\n‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ô‡πÑ‡∏ó‡∏¢\n\nMade with ‚ù§Ô∏è');
});

// Dark Mode Toggle
const darkModeToggle = document.getElementById('dark-mode-toggle-switch');
if (darkModeToggle) {
    // Set initial state based on current theme
    darkModeToggle.checked = window.getCurrentTheme() === 'dark';
    
    // Add event listener
    darkModeToggle.addEventListener('change', (e) => {
        if (e.target.checked) {
            window.toggleDarkMode();
        } else {
            window.toggleDarkMode();
        }
    });
}

// Disabled features
document.querySelectorAll('.setting-item.disabled').forEach(item => {
    item.addEventListener('click', (e) => {
        e.preventDefault();
        const title = item.querySelector('.setting-title').textContent;
        const badge = item.querySelector('.feature-badge');
        
        if (badge.classList.contains('coming-soon')) {
            showToast(`üöÄ ${title}\n\n‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏°‡∏≤‡πÄ‡∏£‡πá‡∏ß‡πÜ ‡∏ô‡∏µ‡πâ\n‡πÄ‡∏£‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏ï‡πá‡∏°‡∏ó‡∏µ‡πà!`, 'info');
        } else if (badge.classList.contains('in-development')) {
            showToast(`üë®‚Äçüíª ${title}\n\n‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤\n‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏£‡πá‡∏ß‡πÜ ‡∏ô‡∏µ‡πâ!`, 'info');
        }
    });
});
</script>
{% endblock %}
